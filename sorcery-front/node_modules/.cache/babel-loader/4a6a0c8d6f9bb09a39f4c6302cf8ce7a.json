{"remainingRequest":"/Users/lvjing/sorcery/sorcery-front/node_modules/babel-loader/lib/index.js!/Users/lvjing/sorcery/sorcery-front/node_modules/eslint-loader/index.js??ref--13-0!/Users/lvjing/sorcery/sorcery-front/src/store/modules/user.js","dependencies":[{"path":"/Users/lvjing/sorcery/sorcery-front/src/store/modules/user.js","mtime":1683709449996},{"path":"/Users/lvjing/sorcery/sorcery-front/babel.config.js","mtime":1658125707026},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1658126181624},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/babel-loader/lib/index.js","mtime":1658126183216},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/eslint-loader/index.js","mtime":1658126181967}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0IGFzIF9sb2dvdXQsIGdldEluZm8gYXMgX2dldEluZm8gfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgSlNFbmNyeXB0IGZyb20gJ2pzZW5jcnlwdCc7Cgp2YXIgZ2V0RGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gZ2V0RGVmYXVsdFN0YXRlKCkgewogIHJldHVybiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiAnJwogIH07Cn07Cgp2YXIgc3RhdGUgPSBnZXREZWZhdWx0U3RhdGUoKTsKdmFyIG11dGF0aW9ucyA9IHsKICBSRVNFVF9TVEFURTogZnVuY3Rpb24gUkVTRVRfU1RBVEUoc3RhdGUpIHsKICAgIE9iamVjdC5hc3NpZ24oc3RhdGUsIGdldERlZmF1bHRTdGF0ZSgpKTsKICB9LAogIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICB9LAogIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgfSwKICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIC8vIHVzZXIgbG9naW4KICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHZhciB1c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lLAogICAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICB2YXIgcHViS2V5ID0gJ01JR2ZNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0R05BRENCaVFLQmdRQ1FrMzNpTmRBOElleTdKNlhyQnNpZHFuNnU4RURMV1BIc2ZFVWdMUTNxaVRpa2hQS0RUelprcEFmVS9PMHg2TnZTS2E3RHAwK3VxV1Qzdm5XMURlMCszdThtQ1lkVmZPZEg5NFZHNHhnNVU1VXJSSmVpOEhoUGlYdXZLUSs2TkJ0ZWJDQ1c1YWRaNHBCZ09pVTE0Y0pMaFZtbStkWWlMbzNJREQ1THFybG9tUUlEQVFBQic7CiAgICB2YXIgZW5jcnlwdCA9IG5ldyBKU0VuY3J5cHQoKTsKICAgIGVuY3J5cHQuc2V0UHVibGljS2V5KHB1YktleSk7CiAgICB2YXIgZW5QYXNzd29yZCA9IGVuY3J5cHQuZW5jcnlwdChwYXNzd29yZCk7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9naW4oewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IGVuUGFzc3dvcmQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCBkYXRhLnRva2VuKTsKICAgICAgICBzZXRUb2tlbihkYXRhLnRva2VuKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2dldEluZm8oc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgLy8gY29uc3QgeyBkYXRhIH0gPSByZXNwb25zZQogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2U7CgogICAgICAgIGlmICghZGF0YSkgewogICAgICAgICAgcmV0dXJuIHJlamVjdCgnVmVyaWZpY2F0aW9uIGZhaWxlZCwgcGxlYXNlIExvZ2luIGFnYWluLicpOwogICAgICAgIH0gLy8gY29uc3QgeyB1c2VybmFtZSwgYXZhdGFyIH0gPSBkYXRhCgoKICAgICAgICB2YXIgbmljayA9IHJlc3BvbnNlLmRhdGEudXNlckluZm8ubmljazsKICAgICAgICB2YXIgYXZhdGFyID0gcmVzcG9uc2UuZGF0YS51c2VySW5mby5hdmF0YXI7CiAgICAgICAgY29tbWl0KCdTRVRfTkFNRScsIG5pY2spOwogICAgICAgIGNvbW1pdCgnU0VUX0FWQVRBUicsIGF2YXRhcik7CiAgICAgICAgcmVzb2x2ZShkYXRhKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHVzZXIgbG9nb3V0CiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQsCiAgICAgICAgc3RhdGUgPSBfcmVmMy5zdGF0ZTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9sb2dvdXQoc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIHJlbW92ZVRva2VuKCk7IC8vIG11c3QgcmVtb3ZlICB0b2tlbiAgZmlyc3QKCiAgICAgICAgcmVzZXRSb3V0ZXIoKTsKICAgICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gcmVtb3ZlIHRva2VuCiAgcmVzZXRUb2tlbjogZnVuY3Rpb24gcmVzZXRUb2tlbihfcmVmNCkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CgogICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAgIHJlc29sdmUoKTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"names":["login","logout","getInfo","getToken","setToken","removeToken","resetRouter","JSEncrypt","getDefaultState","token","name","avatar","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","actions","userInfo","commit","username","password","pubKey","encrypt","setPublicKey","enPassword","Promise","resolve","reject","trim","then","response","data","catch","error","nick","resetToken","namespaced"],"sources":["/Users/lvjing/sorcery/sorcery-front/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/user'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\nimport JSEncrypt from 'jsencrypt'\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    avatar: ''\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  }\n}\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    const { username, password } = userInfo\n    const pubKey = 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCQk33iNdA8Iey7J6XrBsidqn6u8EDLWPHsfEUgLQ3qiTikhPKDTzZkpAfU/O0x6NvSKa7Dp0+uqWT3vnW1De0+3u8mCYdVfOdH94VG4xg5U5UrRJei8HhPiXuvKQ+6NBtebCCW5adZ4pBgOiU14cJLhVmm+dYiLo3IDD5LqrlomQIDAQAB'\n    const encrypt = new JSEncrypt()\n    encrypt.setPublicKey(pubKey)\n    const enPassword = encrypt.encrypt(password)\n    return new Promise((resolve, reject) => {\n      login({ username: username.trim(), password: enPassword }).then(response => {\n        const { data } = response\n        commit('SET_TOKEN', data.token)\n        setToken(data.token)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // get user info\n  getInfo({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      getInfo(state.token).then(response => {\n        // const { data } = response\n        const data = response\n\n        if (!data) {\n          return reject('Verification failed, please Login again.')\n        }\n\n        // const { username, avatar } = data\n        const nick = response.data.userInfo.nick\n        const avatar = response.data.userInfo.avatar\n\n        commit('SET_NAME', nick)\n        commit('SET_AVATAR', avatar)\n        resolve(data)\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // user logout\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken() // must remove  token  first\n        resetRouter()\n        commit('RESET_STATE')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken() // must remove  token  first\n      commit('RESET_STATE')\n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"],"mappings":"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"}]}