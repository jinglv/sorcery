{"remainingRequest":"/Users/lvjing/sorcery/sorcery-front/node_modules/babel-loader/lib/index.js!/Users/lvjing/sorcery/sorcery-front/node_modules/eslint-loader/index.js??ref--13-0!/Users/lvjing/sorcery/sorcery-front/src/store/modules/user.js","dependencies":[{"path":"/Users/lvjing/sorcery/sorcery-front/src/store/modules/user.js","mtime":1662432350757},{"path":"/Users/lvjing/sorcery/sorcery-front/babel.config.js","mtime":1658125707026},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1658126181624},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/babel-loader/lib/index.js","mtime":1658126183216},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/eslint-loader/index.js","mtime":1658126181967}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0IGFzIF9sb2dvdXQsIGdldEluZm8gYXMgX2dldEluZm8gfSBmcm9tICdAL2FwaS91c2VyJzsKaW1wb3J0IHsgZ2V0VG9rZW4sIHNldFRva2VuLCByZW1vdmVUb2tlbiB9IGZyb20gJ0AvdXRpbHMvYXV0aCc7CmltcG9ydCB7IHJlc2V0Um91dGVyIH0gZnJvbSAnQC9yb3V0ZXInOwppbXBvcnQgSlNFbmNyeXB0IGZyb20gJ2pzZW5jcnlwdCc7Cgp2YXIgZ2V0RGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gZ2V0RGVmYXVsdFN0YXRlKCkgewogIHJldHVybiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiAnJwogIH07Cn07Cgp2YXIgc3RhdGUgPSBnZXREZWZhdWx0U3RhdGUoKTsKdmFyIG11dGF0aW9ucyA9IHsKICBSRVNFVF9TVEFURTogZnVuY3Rpb24gUkVTRVRfU1RBVEUoc3RhdGUpIHsKICAgIE9iamVjdC5hc3NpZ24oc3RhdGUsIGdldERlZmF1bHRTdGF0ZSgpKTsKICB9LAogIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICB9LAogIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgfSwKICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIC8vIHVzZXIgbG9naW4KICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHZhciB1c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lLAogICAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICB2YXIgcHViS2V5ID0gJ01JR2ZNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0R05BRENCaVFLQmdRQ1FrMzNpTmRBOElleTdKNlhyQnNpZHFuNnU4RURMV1BIc2ZFVWdMUTNxaVRpa2hQS0RUelprcEFmVS9PMHg2TnZTS2E3RHAwK3VxV1Qzdm5XMURlMCszdThtQ1lkVmZPZEg5NFZHNHhnNVU1VXJSSmVpOEhoUGlYdXZLUSs2TkJ0ZWJDQ1c1YWRaNHBCZ09pVTE0Y0pMaFZtbStkWWlMbzNJREQ1THFybG9tUUlEQVFBQic7CiAgICB2YXIgZW5jcnlwdCA9IG5ldyBKU0VuY3J5cHQoKTsKICAgIGVuY3J5cHQuc2V0UHVibGljS2V5KHB1YktleSk7CiAgICB2YXIgZW5QYXNzd29yZCA9IGVuY3J5cHQuZW5jcnlwdChwYXNzd29yZCk7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9naW4oewogICAgICAgIHVzZXJOYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IGVuUGFzc3dvcmQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCBkYXRhLmFjY2Vzc1Rva2VuKTsKICAgICAgICBzZXRUb2tlbihkYXRhLmFjY2Vzc1Rva2VuKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2dldEluZm8oc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBpZiAoIWRhdGEpIHsKICAgICAgICAgIHJldHVybiByZWplY3QoJ1ZlcmlmaWNhdGlvbiBmYWlsZWQsIHBsZWFzZSBMb2dpbiBhZ2Fpbi4nKTsKICAgICAgICB9CgogICAgICAgIHZhciB1c2VyTmFtZSA9IGRhdGEudXNlck5hbWUsCiAgICAgICAgICAgIGF2YXRhciA9IGRhdGEuYXZhdGFyOwogICAgICAgIGNvbW1pdCgnU0VUX05BTUUnLCB1c2VyTmFtZSk7CiAgICAgICAgY29tbWl0KCdTRVRfQVZBVEFSJywgYXZhdGFyKTsKICAgICAgICByZXNvbHZlKGRhdGEpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gdXNlciBsb2dvdXQKICBsb2dvdXQ6IGZ1bmN0aW9uIGxvZ291dChfcmVmMykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYzLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYzLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2xvZ291dChzdGF0ZS50b2tlbikudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAoKICAgICAgICByZXNldFJvdXRlcigpOwogICAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyByZW1vdmUgdG9rZW4KICByZXNldFRva2VuOiBmdW5jdGlvbiByZXNldFRva2VuKF9yZWY0KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlbW92ZVRva2VuKCk7IC8vIG11c3QgcmVtb3ZlICB0b2tlbiAgZmlyc3QKCiAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"names":["login","logout","getInfo","getToken","setToken","removeToken","resetRouter","JSEncrypt","getDefaultState","token","name","avatar","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","actions","userInfo","commit","username","password","pubKey","encrypt","setPublicKey","enPassword","Promise","resolve","reject","userName","trim","then","response","data","accessToken","catch","error","resetToken","namespaced"],"sources":["/Users/lvjing/sorcery/sorcery-front/src/store/modules/user.js"],"sourcesContent":["import { login, logout, getInfo } from '@/api/user'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport { resetRouter } from '@/router'\nimport JSEncrypt from 'jsencrypt'\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    avatar: ''\n  }\n}\n\nconst state = getDefaultState()\n\nconst mutations = {\n  RESET_STATE: (state) => {\n    Object.assign(state, getDefaultState())\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token\n  },\n  SET_NAME: (state, name) => {\n    state.name = name\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar\n  }\n}\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    const { username, password } = userInfo\n    const pubKey = 'MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCQk33iNdA8Iey7J6XrBsidqn6u8EDLWPHsfEUgLQ3qiTikhPKDTzZkpAfU/O0x6NvSKa7Dp0+uqWT3vnW1De0+3u8mCYdVfOdH94VG4xg5U5UrRJei8HhPiXuvKQ+6NBtebCCW5adZ4pBgOiU14cJLhVmm+dYiLo3IDD5LqrlomQIDAQAB'\n    const encrypt = new JSEncrypt()\n    encrypt.setPublicKey(pubKey)\n    const enPassword = encrypt.encrypt(password)\n    return new Promise((resolve, reject) => {\n      login({ userName: username.trim(), password: enPassword }).then(response => {\n        const { data } = response\n        commit('SET_TOKEN', data.accessToken)\n        setToken(data.accessToken)\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // get user info\n  getInfo({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      getInfo(state.token).then(response => {\n        const { data } = response\n\n        if (!data) {\n          return reject('Verification failed, please Login again.')\n        }\n\n        const { userName, avatar } = data\n\n        commit('SET_NAME', userName)\n        commit('SET_AVATAR', avatar)\n        resolve(data)\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // user logout\n  logout({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      logout(state.token).then(() => {\n        removeToken() // must remove  token  first\n        resetRouter()\n        commit('RESET_STATE')\n        resolve()\n      }).catch(error => {\n        reject(error)\n      })\n    })\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken() // must remove  token  first\n      commit('RESET_STATE')\n      resolve()\n    })\n  }\n}\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n}\n\n"],"mappings":"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"}]}