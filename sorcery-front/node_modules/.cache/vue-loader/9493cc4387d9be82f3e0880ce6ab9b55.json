{"remainingRequest":"/Users/lvjing/sorcery/sorcery-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvjing/sorcery/sorcery-front/src/components/Jenkins/jenkinsTaskDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lvjing/sorcery/sorcery-front/src/components/Jenkins/jenkinsTaskDialog.vue","mtime":1684395391793},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1658126181624},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/babel-loader/lib/index.js","mtime":1658126183216},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1658126181624},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/vue-loader/lib/index.js","mtime":1658126185454}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEplbmtpbnNJbmZvQWxsLCBnZXRKZW5raW5zVGFza0luZm9CeUlkLCBjcmVhdGVKZW5raW5zVGFza0luZm8sIHVwZGF0ZUplbmtpbnNUYXNrSW5mbyB9IGZyb20gJ0AvYXBpL2plbmtpbnMnCgpleHBvcnQgZGVmYXVsdCAoewogIG5hbWU6ICdQb3JqZWN0RGlhbG9nJywKICBjb21wb25lbnRzOiB7fSwKICBwcm9wczogewogICAgdGl0bGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0OiBudWxsCiAgICB9LAogICAgcGlkOiB7CiAgICAgIHR5cGU6IE51bWJlciwKICAgICAgZGVmYXVsdDogMQogICAgfQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGRpYWxvZ1Zpc2libGU6IHRydWUsCiAgICAgIHNob3dUaXRsZTogJycsCiAgICAgIGplbmtpbnNJbmZvVmFsdWU6ICcnLAogICAgICBqZW5raW5zSW5mb0xhYmVsOiAnJywKICAgICAgamVua2luc0luZm9PcHRpb246IFtdLAogICAgICBqZW5raW5zVGFza0Zvcm06IHsKICAgICAgICBqZW5raW5zSWQ6ICcnLAogICAgICAgIGplbmtpbnNKb2JOYW1lOiAnJywKICAgICAgICBqZW5raW5zVGFza05hbWU6ICcnLAogICAgICAgIGNvbW1hbmQ6ICcnLAogICAgICAgIHJlbWFyazogJycKICAgICAgfSwKICAgICAgcnVsZXM6IHsKICAgICAgICBqZW5raW5zSWQ6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fpgInmi6lKZW5raW5z5Lu75YqhJywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdLAogICAgICAgIGplbmtpbnNUYXNrTmFtZTogWwogICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpUplbmtpbnPlkI3np7AnLCB0cmlnZ2VyOiAnYmx1cicgfQogICAgICAgIF0sCiAgICAgICAgamVua2luc0pvYk5hbWU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaVKZW5raW5z5Z+656GA5Zyw5Z2AJywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdLAogICAgICAgIGNvbW1hbmQ6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaVKZW5raW5zIEpvYuS7u+WKoeaJp+ihjOWRveS7pCcsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXQogICAgICB9LAogICAgICBmaWxlTGlzdDogW10sIC8vIOeOsOacieWbvueJh+WIl+ihqAogICAgICBpbWFnZVVybDogJycsIC8vIOWbvueJh+i3r+W+hAogICAgICBpbWFnZVZpc2libGU6IGZhbHNlLAogICAgICBkaXNhYmxlZDogZmFsc2UKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBpZiAodGhpcy50aXRsZSA9PT0gJ2NyZWF0ZScpIHsKICAgICAgdGhpcy5zaG93VGl0bGUgPSAn5Yib5bu6SmVua2luc+S7u+WKoeS/oeaBrycKICAgICAgdGhpcy5pbml0SmVua2luc0luZm9BbGxMaXN0KCkKICAgIH0gZWxzZSBpZiAodGhpcy50aXRsZSA9PT0gJ2RldGFpbCcpIHsKICAgICAgdGhpcy5zaG93VGl0bGUgPSAnSmVua2luc+S7u+WKoeivpuaDhScKICAgICAgdGhpcy5pbml0SmVua2luc1Rhc2tJbmZvRGV0YWlsKCkKICAgIH0gZWxzZSBpZiAodGhpcy50aXRsZSA9PT0gJ2VkaXQnKSB7CiAgICAgIHRoaXMuc2hvd1RpdGxlID0gJ+e8lui+kUplbmtpbnPku7vliqHkv6Hmga8nCiAgICAgIHRoaXMuaW5pdEplbmtpbnNUYXNrSW5mb0RldGFpbCgpCiAgICAgIHRoaXMuaW5pdEplbmtpbnNJbmZvQWxsTGlzdCgpCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBpbml0SmVua2luc0luZm9BbGxMaXN0KCkgewogICAgICBjb25zdCByZXNwID0gYXdhaXQgZ2V0SmVua2luc0luZm9BbGwoKQogICAgICBpZiAocmVzcC5jb2RlID09PSAnMDAwMDAnKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXNwLmRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHRoaXMuamVua2luc0luZm9PcHRpb24ucHVzaCh7CiAgICAgICAgICAgIHZhbHVlOiByZXNwLmRhdGFbaV0uaWQsCiAgICAgICAgICAgIGxhYmVsOiByZXNwLmRhdGFbaV0uamVua2luc05hbWUKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICAgIC8vIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5p+l6K+i5oiQ5Yqf77yBIikKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmn6Xor6LlpLHotKXvvIEnKQogICAgICB9CiAgICB9LAogICAgLy8g5L+u5pS56YCJ5LitSmVua2luc+S7u+WKoQogICAgY2hhbmdlSmVua2lucyh2YWx1ZSkgewogICAgICB0aGlzLmplbmtpbnNJbmZvVmFsdWUgPSB2YWx1ZQogICAgICB0aGlzLmplbmtpbnNJbmZvTGFiZWwgPSB0aGlzLmplbmtpbnNJbmZvT3B0aW9uLmZpbmQoCiAgICAgICAgKGl0ZW0pID0+IGl0ZW0udmFsdWUgPT09IHZhbHVlCiAgICAgICkubGFiZWwKICAgICAgdGhpcy5qZW5raW5zVGFza0Zvcm0uamVua2luc0lkID0gdmFsdWUKICAgIH0sCiAgICAvLyDliJvlu7pKZW5raW5z5Lu75YqhCiAgICBzdWJtaXRKZW5raW5zVGFzayhmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGlmICh0aGlzLnRpdGxlID09PSAnY3JlYXRlJykgewogICAgICAgICAgICBjcmVhdGVKZW5raW5zVGFza0luZm8odGhpcy5qZW5raW5zVGFza0Zvcm0pLnRoZW4oKHJlc3ApID0+IHsKICAgICAgICAgICAgICAvLyBjb2Rl77yaJzAwMDAwJ+ihqOekuuaIkOWKnwogICAgICAgICAgICAgIGlmIChyZXNwLmNvZGUgPT09ICcwMDAwMCcpIHsKICAgICAgICAgICAgICAgIC8vIOWIm+W7uuaIkOWKn++8jOWFs+mXreW8ueeqlwogICAgICAgICAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpCiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ0plbmtpbnPku7vliqHkv6Hmga/liJvlu7rmiJDlip8hJykKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwLm1zZykKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMudGl0bGUgPT09ICdlZGl0JykgewogICAgICAgICAgICB1cGRhdGVKZW5raW5zVGFza0luZm8odGhpcy5waWQsIHRoaXMuamVua2luc1Rhc2tGb3JtKS50aGVuKChyZXNwKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlc3AuY29kZSA9PT0gJzAwMDAwJykgewogICAgICAgICAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpCiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ0plbmtpbnPku7vliqHkv6Hmga/nvJbovpHmiJDlip8hJykKICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcihyZXNwLmVycm9yLmRhdGEpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gZmFsc2UKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgLy8g5qC55o2u6aG555uuSWTmn6Xor6Lpobnnm67or6bmg4UKICAgIGFzeW5jIGluaXRKZW5raW5zVGFza0luZm9EZXRhaWwoKSB7CiAgICAgIGNvbnN0IHJlc3AgPSBhd2FpdCBnZXRKZW5raW5zVGFza0luZm9CeUlkKHRoaXMucGlkKQogICAgICBpZiAocmVzcC5jb2RlID09PSAnMDAwMDAnKSB7CiAgICAgICAgdGhpcy5qZW5raW5zVGFza0Zvcm0gPSByZXNwLmRhdGEKICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoJ0plbmtpbnPku7vliqHkv6Hmga/or6bmg4XmiJDlip8hJykKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCdKZW5raW5z5Lu75Yqh5L+h5oGv6K+m5oOF5aSx6LSlIScpCiAgICAgIH0KICAgIH0sCiAgICAvLyDlhbPpl63nu4Tku7YKICAgIGNsb3NlRGlhbG9nKCkgewogICAgICB0aGlzLiRlbWl0KCdjYW5jZWwnLCB7fSkKICAgIH0KICB9Cn0pCg=="},{"version":3,"sources":["jenkinsTaskDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"jenkinsTaskDialog.vue","sourceRoot":"src/components/Jenkins","sourcesContent":["<template>\n  <el-dialog\n    :title=\"showTitle\"\n    :visible.sync=\"dialogVisible\"\n    width=\"800px\"\n    :before-close=\"closeDialog\"\n  >\n    <el-form\n      v-if=\"title == 'detail'\"\n      :model=\"jenkinsTaskForm\"\n      label-width=\"auto\"\n      class=\"demo-ruleForm\"\n    >\n      <el-form-item label=\"Jenkins名称:\" prop=\"jenkinsId\">{{ jenkinsTaskForm.jenkinsId }}</el-form-item>\n      <el-form-item label=\"Jenkins任务名称:\" prop=\"jenkinsTaskName\">{{ jenkinsTaskForm.jenkinsTaskName }}</el-form-item>\n      <el-form-item label=\"Jenkins Job名称:\" prop=\"jenkinsJobName\">{{ jenkinsTaskForm.jenkinsJobName }}</el-form-item>\n      <el-form-item label=\"command:\" prop=\"command\">{{ jenkinsTaskForm.command }}</el-form-item>\n      <el-form-item type=\"textarea\" label=\"备注:\">{{ jenkinsTaskForm.remark }}</el-form-item>\n      <el-form-item style=\"text-align: right\">\n        <el-button @click=\"closeDialog\">返回</el-button>\n      </el-form-item>\n    </el-form>\n    <el-form\n      v-if=\"title != 'detail'\"\n      ref=\"ruleForm\"\n      :model=\"jenkinsTaskForm\"\n      :rules=\"rules\"\n      label-width=\"auto\"\n      class=\"demo-ruleForm\"\n    >\n      <el-form-item label=\"Jenkins名称\" prop=\"jenkinsId\">\n        <el-select\n          v-model=\"jenkinsTaskForm.jenkinsId\"\n          placeholder=\"请选择Jenkins\"\n          @change=\"changeJenkins\"\n        >\n          <el-option\n            v-for=\"item in jenkinsInfoOption\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"Jenkins任务名称:\" prop=\"jenkinsTaskName\">\n        <el-input v-model=\"jenkinsTaskForm.jenkinsTaskName\" />\n      </el-form-item>\n      <el-form-item label=\"Jenkins Job名称:\" prop=\"jenkinsJobName\">\n        <el-input v-model=\"jenkinsTaskForm.jenkinsJobName\" />\n      </el-form-item>\n      <el-form-item label=\"command:\" prop=\"command\">\n        <el-input v-model=\"jenkinsTaskForm.command\" />\n      </el-form-item>\n      <el-form-item label=\"备注\" prop=\"remark\">\n        <el-input v-model=\"jenkinsTaskForm.remark\" type=\"textarea\" />\n      </el-form-item>\n      <el-form-item style=\"text-align: right\">\n        <el-button @click=\"closeDialog\">取消</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"submitJenkinsTask('ruleForm')\"\n        >确定</el-button>\n      </el-form-item>\n    </el-form>\n  </el-dialog>\n</template>\n\n<script>\nimport { getJenkinsInfoAll, getJenkinsTaskInfoById, createJenkinsTaskInfo, updateJenkinsTaskInfo } from '@/api/jenkins'\n\nexport default ({\n  name: 'PorjectDialog',\n  components: {},\n  props: {\n    title: {\n      type: String,\n      default: null\n    },\n    pid: {\n      type: Number,\n      default: 1\n    }\n  },\n  data() {\n    return {\n      dialogVisible: true,\n      showTitle: '',\n      jenkinsInfoValue: '',\n      jenkinsInfoLabel: '',\n      jenkinsInfoOption: [],\n      jenkinsTaskForm: {\n        jenkinsId: '',\n        jenkinsJobName: '',\n        jenkinsTaskName: '',\n        command: '',\n        remark: ''\n      },\n      rules: {\n        jenkinsId: [\n          { required: true, message: '请选择Jenkins任务', trigger: 'blur' }\n        ],\n        jenkinsTaskName: [\n          { required: true, message: '请输入Jenkins名称', trigger: 'blur' }\n        ],\n        jenkinsJobName: [\n          { required: true, message: '请输入Jenkins基础地址', trigger: 'blur' }\n        ],\n        command: [\n          { required: true, message: '请输入Jenkins Job任务执行命令', trigger: 'blur' }\n        ]\n      },\n      fileList: [], // 现有图片列表\n      imageUrl: '', // 图片路径\n      imageVisible: false,\n      disabled: false\n    }\n  },\n  mounted() {\n    if (this.title === 'create') {\n      this.showTitle = '创建Jenkins任务信息'\n      this.initJenkinsInfoAllList()\n    } else if (this.title === 'detail') {\n      this.showTitle = 'Jenkins任务详情'\n      this.initJenkinsTaskInfoDetail()\n    } else if (this.title === 'edit') {\n      this.showTitle = '编辑Jenkins任务信息'\n      this.initJenkinsTaskInfoDetail()\n      this.initJenkinsInfoAllList()\n    }\n  },\n  methods: {\n    async initJenkinsInfoAllList() {\n      const resp = await getJenkinsInfoAll()\n      if (resp.code === '00000') {\n        for (let i = 0; i < resp.data.length; i++) {\n          this.jenkinsInfoOption.push({\n            value: resp.data[i].id,\n            label: resp.data[i].jenkinsName\n          })\n        }\n        // this.$message.success(\"查询成功！\")\n      } else {\n        this.$message.error('查询失败！')\n      }\n    },\n    // 修改选中Jenkins任务\n    changeJenkins(value) {\n      this.jenkinsInfoValue = value\n      this.jenkinsInfoLabel = this.jenkinsInfoOption.find(\n        (item) => item.value === value\n      ).label\n      this.jenkinsTaskForm.jenkinsId = value\n    },\n    // 创建Jenkins任务\n    submitJenkinsTask(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          if (this.title === 'create') {\n            createJenkinsTaskInfo(this.jenkinsTaskForm).then((resp) => {\n              // code：'00000'表示成功\n              if (resp.code === '00000') {\n                // 创建成功，关闭弹窗\n                this.closeDialog()\n                this.$message.success('Jenkins任务信息创建成功!')\n              } else {\n                this.$message.error(resp.msg)\n              }\n            })\n          } else if (this.title === 'edit') {\n            updateJenkinsTaskInfo(this.pid, this.jenkinsTaskForm).then((resp) => {\n              if (resp.code === '00000') {\n                this.closeDialog()\n                this.$message.success('Jenkins任务信息编辑成功!')\n              } else {\n                this.$message.error(resp.error.data)\n              }\n            })\n          }\n        } else {\n          return false\n        }\n      })\n    },\n    // 根据项目Id查询项目详情\n    async initJenkinsTaskInfoDetail() {\n      const resp = await getJenkinsTaskInfoById(this.pid)\n      if (resp.code === '00000') {\n        this.jenkinsTaskForm = resp.data\n        this.$message.success('Jenkins任务信息详情成功!')\n      } else {\n        this.$message.error('Jenkins任务信息详情失败!')\n      }\n    },\n    // 关闭组件\n    closeDialog() {\n      this.$emit('cancel', {})\n    }\n  }\n})\n</script>\n"]}]}