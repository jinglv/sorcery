{"remainingRequest":"/Users/lvjing/sorcery/sorcery-front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/lvjing/sorcery/sorcery-front/src/components/Jenkins/jenkinsTaskDialog.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/lvjing/sorcery/sorcery-front/src/components/Jenkins/jenkinsTaskDialog.vue","mtime":1684391585621},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1658126181624},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/babel-loader/lib/index.js","mtime":1658126183216},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/cache-loader/dist/cjs.js","mtime":1658126181624},{"path":"/Users/lvjing/sorcery/sorcery-front/node_modules/vue-loader/lib/index.js","mtime":1658126185454}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldEplbmtpbnNJbmZvQWxsLCBnZXRKZW5raW5zVGFza0luZm9CeUlkLCBjcmVhdGVKZW5raW5zSW5mbywgdXBkYXRlSmVua2luc0luZm8gfSBmcm9tICdAL2FwaS9qZW5raW5zJwoKZXhwb3J0IGRlZmF1bHQgKHsKICBuYW1lOiAnUG9yamVjdERpYWxvZycsCiAgY29tcG9uZW50czoge30sCiAgcHJvcHM6IHsKICAgIHRpdGxlOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdDogbnVsbAogICAgfSwKICAgIHBpZDogewogICAgICB0eXBlOiBOdW1iZXIsCiAgICAgIGRlZmF1bHQ6IDEKICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dWaXNpYmxlOiB0cnVlLAogICAgICBzaG93VGl0bGU6ICcnLAogICAgICBqZW5raW5zSW5mb1ZhbHVlOiAnJywKICAgICAgamVua2luc0luZm9MYWJlbDogJycsCiAgICAgIGplbmtpbnNJbmZvT3B0aW9uOiBbXSwKICAgICAgamVua2luc1Rhc2tGb3JtOiB7CiAgICAgICAgamVua2luc0lkOiAnJywKICAgICAgICBqZW5raW5zSm9iTmFtZTogJycsCiAgICAgICAgamVua2luc1Rhc2tOYW1lOiAnJywKICAgICAgICBjb21tYW5kOiAnJywKICAgICAgICByZW1hcms6ICcnCiAgICAgIH0sCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgamVua2luc0lkOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36YCJ5oupSmVua2luc+S7u+WKoScsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXSwKICAgICAgICBqZW5raW5zVGFza05hbWU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICfor7fovpPlhaVKZW5raW5z5ZCN56ewJywgdHJpZ2dlcjogJ2JsdXInIH0KICAgICAgICBdLAogICAgICAgIGplbmtpbnNKb2JOYW1lOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWlSmVua2luc+WfuuehgOWcsOWdgCcsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXSwKICAgICAgICBjb21tYW5kOiBbCiAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWlSmVua2luc+iupOivgeeZu+W9leeUqOaIt+WQjScsIHRyaWdnZXI6ICdibHVyJyB9CiAgICAgICAgXQogICAgICB9LAogICAgICBmaWxlTGlzdDogW10sIC8vIOeOsOacieWbvueJh+WIl+ihqAogICAgICBpbWFnZVVybDogJycsIC8vIOWbvueJh+i3r+W+hAogICAgICBpbWFnZVZpc2libGU6IGZhbHNlLAogICAgICBkaXNhYmxlZDogZmFsc2UKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICBpZiAodGhpcy50aXRsZSA9PT0gJ2NyZWF0ZScpIHsKICAgICAgdGhpcy5zaG93VGl0bGUgPSAn5Yib5bu6SmVua2luc+S7u+WKoeS/oeaBrycKICAgICAgdGhpcy5pbml0SmVua2luc0luZm9BbGxMaXN0KCkKICAgIH0gZWxzZSBpZiAodGhpcy50aXRsZSA9PT0gJ2RldGFpbCcpIHsKICAgICAgdGhpcy5zaG93VGl0bGUgPSAnSmVua2luc+S7u+WKoeivpuaDhScKICAgICAgdGhpcy5pbml0SmVua2luc1Rhc2tJbmZvRGV0YWlsKCkKICAgIH0gZWxzZSBpZiAodGhpcy50aXRsZSA9PT0gJ2VkaXQnKSB7CiAgICAgIHRoaXMuc2hvd1RpdGxlID0gJ+e8lui+kUplbmtpbnPku7vliqHkv6Hmga8nCiAgICAgIHRoaXMuaW5pdEplbmtpbnNUYXNrSW5mb0RldGFpbCgpCiAgICAgIHRoaXMuaW5pdEplbmtpbnNJbmZvQWxsTGlzdCgpCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBhc3luYyBpbml0SmVua2luc0luZm9BbGxMaXN0KCkgewogICAgICBjb25zdCByZXNwID0gYXdhaXQgZ2V0SmVua2luc0luZm9BbGwoKQogICAgICBpZiAocmVzcC5jb2RlID09PSAnMDAwMDAnKSB7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXNwLmRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHRoaXMuamVua2luc0luZm9PcHRpb24ucHVzaCh7CiAgICAgICAgICAgIHZhbHVlOiByZXNwLmRhdGFbaV0uaWQsCiAgICAgICAgICAgIGxhYmVsOiByZXNwLmRhdGFbaV0uamVua2luc05hbWUKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICAgIC8vIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5p+l6K+i5oiQ5Yqf77yBIikKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfmn6Xor6LlpLHotKXvvIEnKQogICAgICB9CiAgICB9LAogICAgLy8g5L+u5pS56YCJ5Lit6aG555uuCiAgICBjaGFuZ2VKZW5raW5zKHZhbHVlKSB7CiAgICAgIHRoaXMuamVua2luc0luZm9WYWx1ZSA9IHZhbHVlCiAgICAgIHRoaXMuamVua2luc0luZm9MYWJlbCA9IHRoaXMuamVua2luc0luZm9PcHRpb24uZmluZCgKICAgICAgICAoaXRlbSkgPT4gaXRlbS52YWx1ZSA9PT0gdmFsdWUKICAgICAgKS5sYWJlbAogICAgICB0aGlzLmplbmtpbnNUYXNrRm9ybS5qZW5raW5zSWQgPSB2YWx1ZQogICAgfSwKICAgIC8vIOWIm+W7uumhueebrgogICAgc3VibWl0SmVua2lucyhmb3JtTmFtZSkgewogICAgICB0aGlzLiRyZWZzW2Zvcm1OYW1lXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGlmICh0aGlzLnRpdGxlID09PSAnY3JlYXRlJykgewogICAgICAgICAgICBjcmVhdGVKZW5raW5zSW5mbyh0aGlzLmplbmtpbnNGb3JtKS50aGVuKChyZXNwKSA9PiB7CiAgICAgICAgICAgICAgLy8gY29kZe+8micwMDAwMCfooajnpLrmiJDlip8KICAgICAgICAgICAgICBpZiAocmVzcC5jb2RlID09PSAnMDAwMDAnKSB7CiAgICAgICAgICAgICAgICAvLyDliJvlu7rmiJDlip/vvIzlhbPpl63lvLnnqpcKICAgICAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKQogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZS5zdWNjZXNzKCdKZW5raW5z5L+h5oGv5Yib5bu65oiQ5YqfIScpCiAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IocmVzcC5tc2cpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIGlmICh0aGlzLnRpdGxlID09PSAnZWRpdCcpIHsKICAgICAgICAgICAgdXBkYXRlSmVua2luc0luZm8odGhpcy5waWQsIHRoaXMuamVua2luc0Zvcm0pLnRoZW4oKHJlc3ApID0+IHsKICAgICAgICAgICAgICBpZiAocmVzcC5jb2RlID09PSAnMDAwMDAnKSB7CiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCkKICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcygnSmVua2luc+S/oeaBr+e8lui+keaIkOWKnyEnKQogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKHJlc3AuZXJyb3IuZGF0YSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICAvLyDmoLnmja7pobnnm65JZOafpeivoumhueebruivpuaDhQogICAgYXN5bmMgaW5pdEplbmtpbnNUYXNrSW5mb0RldGFpbCgpIHsKICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IGdldEplbmtpbnNUYXNrSW5mb0J5SWQodGhpcy5waWQpCiAgICAgIGlmIChyZXNwLmNvZGUgPT09ICcwMDAwMCcpIHsKICAgICAgICB0aGlzLmplbmtpbnNUYXNrRm9ybSA9IHJlc3AuZGF0YQogICAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2VzcygnSmVua2luc+S7u+WKoeS/oeaBr+ivpuaDheaIkOWKnyEnKQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoJ0plbmtpbnPku7vliqHkv6Hmga/or6bmg4XlpLHotKUhJykKICAgICAgfQogICAgfSwKICAgIC8vIOWFs+mXree7hOS7tgogICAgY2xvc2VEaWFsb2coKSB7CiAgICAgIHRoaXMuJGVtaXQoJ2NhbmNlbCcsIHt9KQogICAgfQogIH0KfSkK"},{"version":3,"sources":["jenkinsTaskDialog.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"jenkinsTaskDialog.vue","sourceRoot":"src/components/Jenkins","sourcesContent":["<template>\n  <el-dialog\n    :title=\"showTitle\"\n    :visible.sync=\"dialogVisible\"\n    width=\"800px\"\n    :before-close=\"closeDialog\"\n  >\n    <el-form\n      v-if=\"title == 'detail'\"\n      :model=\"jenkinsTaskForm\"\n      label-width=\"auto\"\n      class=\"demo-ruleForm\"\n    >\n      <el-form-item label=\"Jenkins名称:\" prop=\"jenkinsId\">{{ jenkinsTaskForm.jenkinsId }}</el-form-item>\n      <el-form-item label=\"Jenkins任务名称:\" prop=\"jenkinsTaskName\">{{ jenkinsTaskForm.jenkinsTaskName }}</el-form-item>\n      <el-form-item label=\"Jenkins Job名称:\" prop=\"jenkinsJobName\">{{ jenkinsTaskForm.jenkinsJobName }}</el-form-item>\n      <el-form-item label=\"command:\" prop=\"command\">{{ jenkinsTaskForm.command }}</el-form-item>\n      <el-form-item type=\"textarea\" label=\"备注:\">{{ jenkinsTaskForm.remark }}</el-form-item>\n      <el-form-item style=\"text-align: right\">\n        <el-button @click=\"closeDialog\">返回</el-button>\n      </el-form-item>\n    </el-form>\n    <el-form\n      v-if=\"title != 'detail'\"\n      ref=\"ruleForm\"\n      :model=\"jenkinsTaskForm\"\n      :rules=\"rules\"\n      label-width=\"auto\"\n      class=\"demo-ruleForm\"\n    >\n      <el-form-item label=\"Jenkins名称\" prop=\"jenkinsId\">\n        <el-select\n          v-model=\"jenkinsTaskForm.jenkinsId\"\n          placeholder=\"请选择Jenkins\"\n          label-width=\"auto\"\n          @change=\"changeJenkins\"\n        >\n          <el-option\n            v-for=\"item in jenkinsInfoOption\"\n            :key=\"item.value\"\n            :label=\"item.label\"\n            :value=\"item.value\"\n          />\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"Jenkins任务名称:\" prop=\"jenkinsTaskName\">\n        <el-input v-model=\"jenkinsTaskForm.jenkinsTaskName\" />\n      </el-form-item>\n      <el-form-item label=\"Jenkins任务名称:\" prop=\"jenkinsTaskName\">\n        <el-input v-model=\"jenkinsTaskForm.jenkinsTaskName\" />\n      </el-form-item>\n      <el-form-item label=\"Jenkins Job名称:\" prop=\"jenkinsJobName\">\n        <el-input v-model=\"jenkinsTaskForm.jenkinsJobName\" />\n      </el-form-item>\n      <el-form-item label=\"备注\" prop=\"remark\">\n        <el-input v-model=\"jenkinsTaskForm.remark\" type=\"textarea\" />\n      </el-form-item>\n      <el-form-item style=\"text-align: right\">\n        <el-button @click=\"closeDialog\">取消</el-button>\n        <el-button\n          type=\"primary\"\n          @click=\"submitJenkins('ruleForm')\"\n        >确定</el-button>\n      </el-form-item>\n    </el-form>\n  </el-dialog>\n</template>\n\n<script>\nimport { getJenkinsInfoAll, getJenkinsTaskInfoById, createJenkinsInfo, updateJenkinsInfo } from '@/api/jenkins'\n\nexport default ({\n  name: 'PorjectDialog',\n  components: {},\n  props: {\n    title: {\n      type: String,\n      default: null\n    },\n    pid: {\n      type: Number,\n      default: 1\n    }\n  },\n  data() {\n    return {\n      dialogVisible: true,\n      showTitle: '',\n      jenkinsInfoValue: '',\n      jenkinsInfoLabel: '',\n      jenkinsInfoOption: [],\n      jenkinsTaskForm: {\n        jenkinsId: '',\n        jenkinsJobName: '',\n        jenkinsTaskName: '',\n        command: '',\n        remark: ''\n      },\n      rules: {\n        jenkinsId: [\n          { required: true, message: '请选择Jenkins任务', trigger: 'blur' }\n        ],\n        jenkinsTaskName: [\n          { required: true, message: '请输入Jenkins名称', trigger: 'blur' }\n        ],\n        jenkinsJobName: [\n          { required: true, message: '请输入Jenkins基础地址', trigger: 'blur' }\n        ],\n        command: [\n          { required: true, message: '请输入Jenkins认证登录用户名', trigger: 'blur' }\n        ]\n      },\n      fileList: [], // 现有图片列表\n      imageUrl: '', // 图片路径\n      imageVisible: false,\n      disabled: false\n    }\n  },\n  mounted() {\n    if (this.title === 'create') {\n      this.showTitle = '创建Jenkins任务信息'\n      this.initJenkinsInfoAllList()\n    } else if (this.title === 'detail') {\n      this.showTitle = 'Jenkins任务详情'\n      this.initJenkinsTaskInfoDetail()\n    } else if (this.title === 'edit') {\n      this.showTitle = '编辑Jenkins任务信息'\n      this.initJenkinsTaskInfoDetail()\n      this.initJenkinsInfoAllList()\n    }\n  },\n  methods: {\n    async initJenkinsInfoAllList() {\n      const resp = await getJenkinsInfoAll()\n      if (resp.code === '00000') {\n        for (let i = 0; i < resp.data.length; i++) {\n          this.jenkinsInfoOption.push({\n            value: resp.data[i].id,\n            label: resp.data[i].jenkinsName\n          })\n        }\n        // this.$message.success(\"查询成功！\")\n      } else {\n        this.$message.error('查询失败！')\n      }\n    },\n    // 修改选中项目\n    changeJenkins(value) {\n      this.jenkinsInfoValue = value\n      this.jenkinsInfoLabel = this.jenkinsInfoOption.find(\n        (item) => item.value === value\n      ).label\n      this.jenkinsTaskForm.jenkinsId = value\n    },\n    // 创建项目\n    submitJenkins(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          if (this.title === 'create') {\n            createJenkinsInfo(this.jenkinsForm).then((resp) => {\n              // code：'00000'表示成功\n              if (resp.code === '00000') {\n                // 创建成功，关闭弹窗\n                this.closeDialog()\n                this.$message.success('Jenkins信息创建成功!')\n              } else {\n                this.$message.error(resp.msg)\n              }\n            })\n          } else if (this.title === 'edit') {\n            updateJenkinsInfo(this.pid, this.jenkinsForm).then((resp) => {\n              if (resp.code === '00000') {\n                this.closeDialog()\n                this.$message.success('Jenkins信息编辑成功!')\n              } else {\n                this.$message.error(resp.error.data)\n              }\n            })\n          }\n        } else {\n          return false\n        }\n      })\n    },\n    // 根据项目Id查询项目详情\n    async initJenkinsTaskInfoDetail() {\n      const resp = await getJenkinsTaskInfoById(this.pid)\n      if (resp.code === '00000') {\n        this.jenkinsTaskForm = resp.data\n        this.$message.success('Jenkins任务信息详情成功!')\n      } else {\n        this.$message.error('Jenkins任务信息详情失败!')\n      }\n    },\n    // 关闭组件\n    closeDialog() {\n      this.$emit('cancel', {})\n    }\n  }\n})\n</script>\n"]}]}